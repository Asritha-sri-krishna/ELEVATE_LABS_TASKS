CREATE DATABASE IF NOT EXISTS sales_db;
USE sales_db;

DROP TABLE IF EXISTS online_sales;

CREATE TABLE online_sales (
    order_id INT PRIMARY KEY,
    order_date DATE NOT NULL,
    amount DECIMAL(10,2) NOT NULL,
    product_id INT NOT NULL
);




INSERT INTO online_sales (order_id, order_date, amount, product_id) VALUES
(1, '2024-01-02', 250.00, 101),
(2, '2024-01-05', 300.00, 102),
(3, '2024-01-08', 150.00, 103),
(4, '2024-01-10', 450.00, 104),
(5, '2024-01-15', 500.00, 105),
(6, '2024-01-20', 350.00, 106),
(7, '2024-01-22', 200.00, 107),
(8, '2024-01-25', 800.00, 108),
(9, '2024-01-28', 1000.00, 109),
(10, '2024-01-30', 400.00, 110),

(11, '2024-02-02', 600.00, 101),
(12, '2024-02-05', 450.00, 102),
(13, '2024-02-08', 300.00, 103),
(14, '2024-02-10', 700.00, 104),
(15, '2024-02-12', 1200.00, 105),
(16, '2024-02-15', 900.00, 106),
(17, '2024-02-18', 750.00, 107),
(18, '2024-02-20', 400.00, 108),
(19, '2024-02-25', 650.00, 109),
(20, '2024-02-28', 500.00, 110),

(21, '2024-03-01', 950.00, 101),
(22, '2024-03-03', 1100.00, 102),
(23, '2024-03-06', 600.00, 103),
(24, '2024-03-08', 450.00, 104),
(25, '2024-03-10', 700.00, 105),
(26, '2024-03-12', 850.00, 106),
(27, '2024-03-15', 300.00, 107),
(28, '2024-03-18', 1200.00, 108),
(29, '2024-03-22', 500.00, 109),
(30, '2024-03-28', 1000.00, 110),

(31, '2024-04-01', 400.00, 101),
(32, '2024-04-03', 900.00, 102),
(33, '2024-04-07', 750.00, 103),
(34, '2024-04-10', 1200.00, 104),
(35, '2024-04-12', 300.00, 105),
(36, '2024-04-15', 950.00, 106),
(37, '2024-04-18', 1100.00, 107),
(38, '2024-04-20', 600.00, 108),
(39, '2024-04-25', 450.00, 109),
(40, '2024-04-28', 700.00, 110),

(41, '2024-05-01', 850.00, 101),
(42, '2024-05-05', 300.00, 102),
(43, '2024-05-07', 1200.00, 103),
(44, '2024-05-10', 900.00, 104),
(45, '2024-05-12', 750.00, 105),
(46, '2024-05-15', 400.00, 106),
(47, '2024-05-18', 650.00, 107),
(48, '2024-05-20', 500.00, 108),
(49, '2024-05-22', 950.00, 109),
(50, '2024-05-28', 1100.00, 110),

(51, '2024-06-01', 600.00, 101),
(52, '2024-06-03', 450.00, 102),
(53, '2024-06-05', 1200.00, 103),
(54, '2024-06-07', 800.00, 104),
(55, '2024-06-10', 500.00, 105),
(56, '2024-06-12', 400.00, 106),
(57, '2024-06-15', 650.00, 107),
(58, '2024-06-18', 950.00, 108),
(59, '2024-06-20', 1100.00, 109),
(60, '2024-06-25', 700.00, 110),

(61, '2024-07-01', 900.00, 101),
(62, '2024-07-05', 750.00, 102),
(63, '2024-07-07', 300.00, 103),
(64, '2024-07-10', 1200.00, 104),
(65, '2024-07-12', 950.00, 105),
(66, '2024-07-15', 1100.00, 106),
(67, '2024-07-18', 400.00, 107),
(68, '2024-07-20', 600.00, 108),
(69, '2024-07-25', 450.00, 109),
(70, '2024-07-28', 700.00, 110),



(71, '2024-08-01', 850.00, 101),
(72, '2024-08-03', 300.00, 102),
(73, '2024-08-06', 1200.00, 103),
(74, '2024-08-08', 900.00, 104),
(75, '2024-08-12', 750.00, 105),
(76, '2024-08-15', 400.00, 106),
(77, '2024-08-18', 650.00, 107),
(78, '2024-08-20', 500.00, 108),
(79, '2024-08-22', 950.00, 109),
(80, '2024-08-28', 1100.00, 110),

(81, '2024-09-01', 600.00, 101),
(82, '2024-09-03', 450.00, 102),
(83, '2024-09-05', 1200.00, 103),
(84, '2024-09-07', 800.00, 104),
(85, '2024-09-10', 500.00, 105),
(86, '2024-09-12', 400.00, 106),
(87, '2024-09-15', 650.00, 107),
(88, '2024-09-18', 950.00, 108),
(89, '2024-09-20', 1100.00, 109),
(90, '2024-09-25', 700.00, 110),

(91, '2024-10-01', 900.00, 101),
(92, '2024-10-05', 750.00, 102),
(93, '2024-10-07', 300.00, 103),
(94, '2024-10-10', 1200.00, 104),
(95, '2024-10-12', 950.00, 105),
(96, '2024-10-15', 1100.00, 106),
(97, '2024-10-18', 400.00, 107),
(98, '2024-10-20', 600.00, 108),
(99, '2024-10-25', 450.00, 109),
(100, '2024-10-28', 700.00, 110);


SELECT
    YEAR(order_date) AS year,
    MONTH(order_date) AS month,
    SUM(amount) AS total_revenue,
    COUNT(DISTINCT order_id) AS total_orders
FROM online_sales
GROUP BY YEAR(order_date), MONTH(order_date)
ORDER BY year, month;


SELECT
    YEAR(order_date) AS year,
    MONTH(order_date) AS month,
    SUM(amount) AS total_revenue
FROM online_sales
GROUP BY YEAR(order_date), MONTH(order_date)
ORDER BY total_revenue DESC
LIMIT 3;

